function addData(t,e,o,n){if(!n[t])n[t]=[];n[t][e]=o.replace(",","")}export function downloadHtmlTableToCSV(e=[],t="Exported CSV",o=""){const a=[];let n=false;let l=0;for(let t=0;t<e.length;t++){const i=e[t];const f=`#${i} tr`;const u=document.querySelectorAll(f);for(let t=0;t<u.length;t++){const p=u[t];if(!p)continue;const b=p.querySelectorAll("td, th");let c=0;b.forEach(t=>{const e=parseInt(t.getAttribute("rowspan")||"1");const o=parseInt(t.getAttribute("colspan")||"1");const n=t.textContent;for(let t=0;t<e;t++){while(a?.[l]?.[c]===""){c++}if(t===0)addData(l,c,n,a);else addData(l+t,c,"",a)}for(let t=0;t<o;t++){if(t===0)addData(l,c,n,a);else{addData(l,c,"",a)}c++}});if(o&&p.id===o){n=true;break}l++}l=l+5;if(n)break}const c=a.map(t=>t.join(",")).join("\n");const d=new Blob([c],{type:"text/csv"});const r=window.URL.createObjectURL(d);const s=document.createElement("a");s.href=r;s.download=t+".csv";document.body.appendChild(s);s.click();window.URL.revokeObjectURL(r);document.body.removeChild(s)}